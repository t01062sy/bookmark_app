# 開発再開ガイド

**作成日**: 2025年8月10日  
**対象**: ブックマークアプリ開発の中断・再開  
**次回開始フェーズ**: Phase 2A - LLM パイプライン実装

---

## 🎯 現在の開発状況

### ✅ 完了済み（Phase 1A + 1B）
- **Phase 1A**: iOS プロトタイプ完全実装
- **Phase 1B Week 1**: Supabase データベース基盤構築  
- **Phase 1B Week 2**: Edge Functions API実装（POST/GET bookmarks）
- **Phase 1B Week 3**: iOS アプリ API統合・同期機能

### 🎖️ 達成した機能
1. **完全動作するiOSアプリ**: iPhone 15 Pro (iOS 17.5) シミュレータ動作確認済み
2. **本番稼働API**: Supabase Edge Functions で POST/GET エンドポイント稼働中
3. **リアルタイム同期**: Swift Data ↔ Supabase 双方向データ同期
4. **包括的テスト**: 全機能のCRUD・検索・フィルタ動作確認済み

---

## 🚀 次回開発開始手順

### Step 1: 環境確認（5分）

#### プロジェクト状態確認
```bash
# リポジトリ移動
cd /Users/shohei.yoneda/playground/bookmark_app

# 最新状態確認
git status
git log --oneline -5

# Supabase API動作確認
curl -X GET 'https://ieuurvmlrgkxfetfnlnp.supabase.co/functions/v1/bookmarks-list' \
  -H 'Authorization: Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImlldXVydm1scmdreGZldGZubG5wIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTQ4MDkyNTksImV4cCI6MjA3MDM4NTI1OX0.VPYLmJsdgnLvSBZNmAaDbod3ecWbTtIc0fDneGvgO-E'
```

#### iOSアプリ動作確認
```bash
# iOS シミュレータ起動
xcrun simctl boot "iPhone 15 Pro"
open -a Simulator

# アプリビルド・起動テスト
cd ios/BookmarkApp
xcodebuild -project BookmarkApp.xcodeproj -scheme BookmarkApp \
  -configuration Debug -sdk iphonesimulator \
  -destination "platform=iOS Simulator,name=iPhone 15 Pro,OS=17.5" \
  build
```

### Step 2: Phase 2A 開始準備（30分）

#### OpenAI API準備
1. **OpenAI アカウント確認**
   - https://platform.openai.com にログイン
   - API キー作成・取得
   - 課金設定確認（$30/月上限設定）

2. **ローカル環境設定**
```bash
# .secrets ファイルに OpenAI キー追加
echo "OPENAI_API_KEY=sk-..." >> .secrets
echo "OPENAI_ORGANIZATION_ID=org-..." >> .secrets  # 必要に応じて
```

#### 開発計画確認
```bash
# 最新の開発計画書確認
cat 開発計画書.md | grep -A 20 "Phase 2A"

# Edge Functions ガイド確認
cat docs/setup/edge-functions-guide.md
```

### Step 3: Phase 2A Week 1 実装開始

#### 最優先タスク
1. **OpenAI API 基本テスト** (2-3時間)
   - 新しい Edge Function: `llm-process` 作成
   - gpt-4o-mini 基本連携テスト
   - プロンプト設計・テスト

2. **OGP/oEmbed パーサー** (1-2日)
   - URL メタデータ取得機能
   - YouTube Data API 連携準備
   - 本文抽出（Readability.js 相当）

3. **コスト監視システム** (1日)
   - OpenAI API 使用量追跡
   - $1/日、$30/月 上限チェック
   - Supabase Functions での実装

---

## 📁 重要ファイル・パス

### 🔑 認証・設定ファイル
```
.secrets                          # Supabase + OpenAI API キー
supabase/.env                     # Edge Functions 環境変数
```

### 🛠️ 実装済みコード
```
ios/BookmarkApp/BookmarkApp/
├── Services/
│   ├── BookmarkAPIClient.swift   # HTTP クライアント
│   └── BookmarkSyncService.swift # データ同期
├── Models/Bookmark.swift         # データモデル
└── Views/                        # 全UI（API統合済み）

supabase/functions/
├── bookmarks-create/index.ts     # POST API
└── bookmarks-list/index.ts       # GET API
```

### 📚 ドキュメント
```
docs/setup/
├── supabase-setup-guide.md       # Supabase 構築ガイド
├── edge-functions-guide.md       # API 実装ガイド
└── secrets-management.md         # 認証情報管理

開発計画書.md                      # 全体ロードマップ
```

---

## 🔧 トラブルシューティング

### よくある問題

#### 1. Supabase API 接続エラー
```bash
# API キー確認
grep "SUPABASE_ANON_KEY" .secrets

# プロジェクト状態確認
curl -X GET 'https://ieuurvmlrgkxfetfnlnp.supabase.co/rest/v1/bookmarks?select=*' \
  -H 'apikey: [ANON_KEY]'
```

#### 2. iOS シミュレータ問題
```bash
# 推奨: iPhone 15 Pro (iOS 17.5) 使用
xcrun simctl list devices | grep "iPhone 15 Pro"
xcrun simctl boot "iPhone 15 Pro"

# 互換性エラー時は iOS 17.5 デバイス選択
```

#### 3. Edge Functions デプロイ問題
```bash
# ログイン状態確認
supabase --version
# 必要に応じて再デプロイ
supabase functions deploy --project-ref ieuurvmlrgkxfetfnlnp
```

---

## 📊 成功指標（現在達成状況）

### ✅ Phase 1B 達成済み
- [x] **API応答時間**: P95 < 3秒 ✅
- [x] **データベース接続**: 安定動作 ✅  
- [x] **iOS アプリ起動**: <1秒 ✅
- [x] **基本CRUD**: 全機能動作 ✅

### 🎯 Phase 2A 目標
- [ ] **LLM処理成功率**: ≥ 95%
- [ ] **要約生成時間**: P95 < 20秒
- [ ] **日次LLMコスト**: < $1.00
- [ ] **月次運用コスト**: < $30

---

## 🎯 MVP完成までの見積もり

### 残り作業（4-6週間）
1. **Phase 2A (LLM)**: 2-3週間
2. **Phase 2B (検索強化)**: 1-2週間  
3. **Phase 3A (Web PWA)**: 3-4週間
4. **Phase 4A (仕上げ)**: 1週間

### 最短ルート（4週間）
- **Week 1**: OpenAI統合 + LLM基本機能
- **Week 2**: 品質向上 + 高度検索
- **Week 3**: Web PWA 基本実装
- **Week 4**: 最終仕上げ・本番準備

---

## 🔥 即座開始可能

**すべてのインフラ・基盤は整っています！**

1. OpenAI API キー取得
2. `supabase/functions/llm-process/` フォルダ作成
3. 基本LLM統合開始

**次回開発時間**: 最低3-4時間あれば Phase 2A Week 1 の基本実装に着手可能

**🚀 いつでも開発再開できる状態です！**